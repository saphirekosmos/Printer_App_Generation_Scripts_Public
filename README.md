# Printer_App_Generation_Scripts_Public
#######################################
Readme for the Printer App Creation scripts. 
GMaddox 
10-1-21
#######################################

This set of scripts can be used to semi-automatically create and depploy printer through SCCM as applications. This should bypass Print nightmare issues by using the system account to install rather than the user. Each application will install and uninatll via software center. 
  NOTE: Due to how the printer is installed you will not be able to manually remove it, even as an admin. You have to uninstall it using the uninstall script. 

For our system we have 2 primary print servers, one for MFPs and one for Non-MFPs. To prevent any potential overal in the creation I created 1 set of scripts for each. For the most part they are the same, the main difference is in some of the starting variables used for the naming. 

I also split the process into 3 main "Parts" with a script for each. This was primarily so that I could create and test each one on it's own in addition to the fact that we may have wanted to use the scripts to do one of the Parts and not the others. 

For reference we have the following servers and shares:
  SCCMSiteServer.OurDomain.edu <-- Primary Site Server
  \\SCCMSiteServer.OurDomain.edu\source <-- Source Folder for our Apps (Not the content libary or DP)
    A folder under "\Software Library\Overview\Application Management\Applications\" named "Printers" <-- Where all our printer apps will be stored as to not saturate our normal app folders.
  PrintServer-MFP.OurDomain.edu <-- MFP Server
  PrintServer-NonMFP.OurDomain.edu <-- Non-MFP Server

While I will be referring to the "MFP Printers" scripts in teh next section git is the same for "Printers"

The process for using these is:

Part 1: 
  Export list of printers from the print server and name it "MFPprinters.csv".
  Drop the above file into "MFP-Printers\Source Files". 
  Run "PART-1_Create-SCCM-Printer-Apps_MFP_Create-Install-Scripts.ps1" 
  This will create a folder for each printer in "MFP-Printers\Printer Install Scripts". The folder will be named after the printer.
  
Part 2: 
  Run "PART-2_Create-SCCM-Printer-Apps_MFP_Create-CM-App.ps1".
    This will copy the folders in "MFP-Printers\Printer Install Scripts" your source folder. 
    Will load the folders in "MFP-Printers\Printer Install Scripts" into an array and then loop through that to create an application for each printer based on the folder name. 
      Creates the application, adds a deployment type with a powershell script detection rule that searches the registry for the printer entry, and finally moves the app into a folder under Application named "Printers"
      
Part 3: 
  Create a CSV with the proper collection and printer associations and name it "MFPPrintersPorts.csv".
  Drop the above file into "MFP-Printers\Source Files". 
  Run "PART-3_Create-SCCM-Printer-Apps_MFP_Create-App-Deployments.ps1"
    This will create an available deployment for each app in the "MFPPrintersPorts.csv" deployed to the specified collection. We are deploying to collection based on buildings. 

The apps will now show in Software Center and can be installed by users. 
  
#######################################
Files
#######################################

Here are the relevant files.

MFP Printer Creation scripts:
  Install Script Generation scripts
    PART-1_Create-SCCM-Printer-Apps_MFP_Create-Install-Scripts.ps1 <-- Included in "MFP-Printers".
      Install_Printer_TEMPLATE.cmd <-- Included in "MFP-Printers\Source Files".
      UnInstall_Printer_TEMPLATE.cmd <-- Included in "MFP-Printers\Source Files".
      MFPprinters.csv <-- Generated from print server by going to the "Print Management" mmc and exporting a .csv of your printers. Put into "MFP-Printers\Source Files"

  Log File:
    Script_Creation_Log.txt <-- Generated by the script.

  SCCM App Creation Scripts
    PART-2_Create-SCCM-Printer-Apps_MFP_Create-CM-App.ps1 <-- Included in "MFP-Printers".
      MFP-Printer.png <-- Included in "MFP-Printers\Source Files".
  Log File:
    SCCM_App_Creation_Log.txt <-- Generated by the script.
        
  Deployment Scripts
    PART-3_Create-SCCM-Printer-Apps_MFP_Create-App-Deployments.ps1 <-- Included in "MFP-Printers".
      MFPPrintersPorts.csv <-- Must be manually created. Contains the associations of what collections each printer are deployed to. Format is "Collection Name,IPRange,Printer Share Name" Put into "MFP-Printers\Source Files"
  Log File:
    Deployment_MFPPrinters_Log_Prod.txt <-- Generated by the script.
  
  Example Files:
    Example CSV in "MFP-Printers\Source Files".
    Example of generated Printer Install script in "MFP-Printers\Printer Install Scripts".
    
Non-MFP Printers Creation scripts:
  Install Script Generation scripts
    PART-1_Create-SCCM-Printer-Apps_Printer_Create-Install-Scripts.ps1 <-- Included in "Printers".
      Install_Printer_TEMPLATE.cmd <-- Included in "Printers\Source Files".
      UnInstall_Printer_TEMPLATE.cmd <-- Included in "Printers\Source Files".
      Printers.csv <-- Generated from print server by going to the "Print Management" mmc and exporting a .csv of your printers. Put into "Printers\Source Files"

  SCCM App Creation Scripts
    PART-2_Create-SCCM-Printer-Apps_Printer_Create-CM-App.ps1 <-- Included in "Printers".
      Printer.png <-- Included in "Printers\Source Files".
        
  Deployment Scripts
    PART-3_Create-SCCM-Printer-Apps_Printer_Create-App-Deployments.ps1 <-- Included in "Printers".
      PrintersPorts.csv <-- Must be manually created. Contains the associations of what collections each printer are deployed to. Format is "Collection Name,IPRange,Printer Share Name" Put into "Printers\Source Files"
    
  Log Files
    Deployment_Printers_Log_Prod.txt <-- Generated by the script.

  Example Files:
    Example CSV in "Printers\Source Files".
    Example of generated Printer Install script in "Printers\Printer Install Scripts".
    
#######################################
Log Files Output Examples
#######################################

Universal Across Logs:

  Time/Section Stamps:

  Starting Script Creation Script.
  10/01/2021 14:56:54 
  -----------------------------

  ----End Package Script----
  10/01/2021 14:56:55 
  -----------------------------

  Loading source folders.
  10/01/2021 14:58:56 
  -----------------------------
  Beginning bulk App Creation.
  10/01/2021 14:58:56 
  -----------------------------

-----------------------------
Script_Creation_Log.txt: 
-----------------------------

  Starting Script Creation Script.
  10/01/2021 14:56:54 
  -----------------------------
  #######################################
  Creating output directory for: DEPT-ROOM101
  Creating Install script for: DEPT-ROOM101
  Creating UnInstall script for: DEPT-ROOM101
  #######################################
  ----End Package Script----
  10/01/2021 14:56:55 
  -----------------------------

-----------------------------
SCCM_App_Creation_Log.txt:
-----------------------------

  Starting Package Script
  10/01/2021 14:58:56 
  -----------------------------
  Loading source folders.
  10/01/2021 14:58:56 
  -----------------------------
  Beginning bulk App Creation.
  10/01/2021 14:58:56 
  -----------------------------
  ###################################################
  Initiating App creation for: "MFP-Printer: DEPT-ROOM101"
  10/01/2021 15:00:15 
  ###################################################


  -----------------------------
  Creating "MFP-Printer: DEPT-ROOM101"
  10/01/2021 15:00:15 
  -----------------------------
  Moving "MFP-Printer: DEPT-ROOM101"
  10/01/2021 15:00:17 
  -----------------------------
  Creating Deployment Type "MFP-Printer: DEPT-ROOM101"
  10/01/2021 15:00:18 
  -----------------------------
  Creating deployment dependancy for "MFP-Printer: DEPT-ROOM101"
  10/01/2021 15:00:22 
  -----------------------------
  Distributing "MFP-Printer: DEPT-ROOM101"
  10/01/2021 15:00:31 
  -----------------------------

-----------------------------
Deployment_MFPPrinters_Log_Prod.txt:
-----------------------------

  Starting Deployment Script
  10/01/2021 15:08:13 
  -----------------------------
  Loading SCCM modules.
  10/01/2021 15:08:13 
  -----------------------------
  Beginning bulk App Deployments.
  10/01/2021 15:08:13 
  -----------------------------
  Application: "MFP-Printer: DEPT-ROOM101" Deployed to Collection: "Printers - Building" successfully.
  ________________________________
  ----End Package Script----
  10/01/2021 15:09:05 
  -----------------------------

-----------------------------
General Error Example:
-----------------------------

Text after "Error Detail:" comes directly from the error text Powershell generates. 

  ERROR: Copying source files for "MFP-Printer: DEPT-ROOM101" failed. Source directory already exists.
  10/01/2021 15:00:15 
  -----------------------------

  WARNING: Error creating App named "MFP-Printer: DEPT-ROOM101". Error Detail: "An object with the specified name already exists."
  10/01/2021 14:59:14 
  -----------------------------




















